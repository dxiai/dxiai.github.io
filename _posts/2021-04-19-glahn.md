---
layout: post
title: Summarise-freundlicher Wilcoxon-Test
author: Christian Glahn
date: 2021-04-13
tags: 
- statistik
- praxis
- tidyverse
---

Der Wilcoxon-Test ist ein wichtiger Test, um nicht normalverteilte Skalenniveaus zu vergleichen. Leider ist in [`infer`]() keine entsprechende Funktion vorhanden und die Funktion [`wilcox.test`]() aus `stats` ist mit dplyr super umständlich zu bedienen. Hier wäre eine `summarise`-freundliche Funktion wünschenswert. Dieser Beitrag erkundet Strategien, wie wir `tidyverse`-freundliche Funktionen schreiben.

Die Funktion ist recht einfach und intuitiver als die standard Funktion. Sie hält sich auch an die Namenskonventionen von `infer`: 

```R
wilcox_test = function(response, explanatory, subset = c(), ...) {
    if (length(subset) != 2)
        subset = unique(explanatory)
    
    tibble(response, explanatory) %>% 
        wilcox.test(response ~ explanatory, ., explanatory %in% subset, ...) %>% 
        tidy
}
```

Wir können damit in `summarise()` mehrere Wilcoxon Tests in einem Rutsch durchführen. 

```R
daten %>% 
    summarise(
        u00_1_kurs= q00_1 %>% wilcox_test(explanatory = kurs,  alternative = "two.sided") %>% pull(p.value),
        u00_1_q00_2 =  q00_1 %>% wilcox_test(explanatory = kurs,  subset = c("M", "W"), alternative = "two.sided") %>% pull(p.value)
    )
```

Achtung: `list()` oder `pull(p.value)` wurden absichtlich nicht in die Funktion eingebunden, damit wir die Freiheit haben, die entsprechende Manipulation selbst durchzuführen.


> Im Gegensatz zur COIN bibliothek ist dieser Test keine Neuimplementierung, sondern kapselt nur die originale Funktionalität. 

